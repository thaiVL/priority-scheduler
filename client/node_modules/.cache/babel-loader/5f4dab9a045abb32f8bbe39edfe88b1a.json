{"ast":null,"code":"var _jsxFileName = \"/Users/trang/cmpt370/cmpt-370-project-group-27/client/src/pages/Login.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport * as ROUTES from '../constants/routes';\nimport { testToken } from '../service/tokenService';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Login(_ref) {\n  _s();\n\n  let {\n    token,\n    setToken\n  } = _ref;\n  const [emailAddress, setEmailAddress] = useState('');\n  const [password, setPassword] = useState(''); // const [remember, setRemember] = useState(false);\n\n  const [error, setError] = useState('');\n  const history = useHistory();\n  useEffect(() => {\n    document.title = 'Login - Priori';\n\n    if (token) {\n      testToken(token.token_string).then(data => {\n        if (data) {\n          history.push(ROUTES.DASHBOARD);\n        }\n      });\n    }\n  }, []);\n\n  const handleLogin = async event => {\n    event.preventDefault();\n    login(emailAddress, password).then(result => {\n      if (result.isLoggedIn) {\n        history.push(ROUTES.DASHBOARD);\n      } else {\n        setEmailAddress('');\n        setPassword('');\n        setError(result.msg);\n      }\n    });\n  };\n\n  function login(emailAddress, password) {\n    var status;\n    return fetch(\"/login\", {\n      method: \"POST\",\n      headers: {\n        \"Accept\": \"application/json\",\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        email: emailAddress,\n        password: password\n      })\n    }).then(res => {\n      status = res.status;\n      return res.json();\n    }).then(data => {\n      if (status !== 200) {\n        console.log(data[0].msg);\n        localStorage.removeItem(\"token\");\n        return {\n          isLoggedIn: false,\n          msg: data[0].msg\n        };\n      } else {\n        // data will be the token upon success\n        console.log(\"return a token in Login\");\n        localStorage.setItem(\"token\", data);\n        setToken(data);\n        return {\n          isLoggedIn: true,\n          msg: ''\n        };\n      }\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"header pink\",\n        children: \"Priori\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"red\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 27\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleLogin,\n        method: \"POST\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: /*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Email\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 28\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Enter Email\",\n          value: emailAddress,\n          onChange: _ref2 => {\n            let {\n              target\n            } = _ref2;\n            return setEmailAddress(target.value);\n          },\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: /*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 28\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          placeholder: \"Enter Password\",\n          value: password,\n          onChange: _ref3 => {\n            let {\n              target\n            } = _ref3;\n            return setPassword(target.value);\n          },\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button\",\n          type: \"submit\",\n          children: \"Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"login_line\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"directing\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          type: \"submit\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [\"Don't have an account?\", /*#__PURE__*/_jsxDEV(\"a\", {\n              className: \"underline_bold\",\n              href: ROUTES.SIGN_UP,\n              children: \" Sign up\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 29\n            }, this), \".\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Login, \"9x7lyiRV5O/+vR7NWkiM/YMc1iY=\", false, function () {\n  return [useHistory];\n});\n\n_c = Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/Users/trang/cmpt370/cmpt-370-project-group-27/client/src/pages/Login.js"],"names":["useState","useEffect","useHistory","ROUTES","testToken","Login","token","setToken","emailAddress","setEmailAddress","password","setPassword","error","setError","history","document","title","token_string","then","data","push","DASHBOARD","handleLogin","event","preventDefault","login","result","isLoggedIn","msg","status","fetch","method","headers","body","JSON","stringify","email","res","json","console","log","localStorage","removeItem","setItem","target","value","SIGN_UP"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport * as ROUTES from '../constants/routes';\nimport { testToken } from '../service/tokenService';\n\n\nexport default function Login({token, setToken}) {\n    const [emailAddress, setEmailAddress] = useState('');\n    const [password, setPassword] = useState('');\n    // const [remember, setRemember] = useState(false);\n    const [error, setError] = useState('');\n    const history = useHistory();\n\n    useEffect(() =>{\n        document.title = 'Login - Priori';\n        if (token){\n            testToken(token.token_string)\n            .then(data =>{\n                if (data){\n                    history.push(ROUTES.DASHBOARD);\n                }\n            });\n        }\n    },[]);\n\n    const handleLogin = async (event ) => {\n        event.preventDefault();\n        login(emailAddress, password)\n        .then( result => {\n            if (result.isLoggedIn){\n                history.push(ROUTES.DASHBOARD);\n            }\n            else{\n                setEmailAddress('');\n                setPassword('');\n                setError(result.msg);\n            }\n        });\n\n    };\n\n    function login(emailAddress, password){\n        var status;\n        return fetch(\"/login\", {\n                method: \"POST\",\n                headers: {\n                    \"Accept\": \"application/json\",\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({email: emailAddress, password: password})\n            })\n            .then(res => {\n                status = res.status\n                return res.json();\n            })\n            .then(data => {\n                if(status !== 200){\n                    console.log(data[0].msg);\n                    localStorage.removeItem(\"token\");\n                    return {isLoggedIn: false, msg: data[0].msg};\n                }\n                else{\n                    // data will be the token upon success\n                    console.log(\"return a token in Login\");\n                    localStorage.setItem(\"token\", data);\n                    setToken(data);\n                    return {isLoggedIn: true, msg: ''};\n                }\n            })\n    }\n\n    return (\n        <div className=\"App\">\n            <div className=\"App-header\">\n                <h1 className=\"header pink\">Priori</h1>\n                <br />\n                {error && <p className=\"red\">{error}</p>}\n                <br />\n                <form onSubmit={handleLogin} method=\"POST\">\n                    <label><b>Email</b></label>\n                    <input\n                        type=\"text\"\n                        placeholder=\"Enter Email\"\n                        value={emailAddress}\n                        onChange={({ target }) => setEmailAddress(target.value)}\n                        required />\n\n                    <label><b>Password</b></label>\n                    <input\n                        type=\"password\"\n                        placeholder=\"Enter Password\"\n                        value={password}\n                        onChange={({ target }) => setPassword(target.value)}\n                        required />\n                    <button className=\"button\" type=\"submit\">Login</button>\n                    <div className=\"login_line\" />\n                </form>\n                <form className=\"directing\">\n                    <p type=\"submit\">\n                        <span>\n                            Don't have an account? \n                            <a className=\"underline_bold\" href={ROUTES.SIGN_UP}> Sign up</a>\n                            .\n                        </span>\n                    </p>\n                </form>\n            </div>\n        </div>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}